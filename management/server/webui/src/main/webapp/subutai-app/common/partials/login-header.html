<div ng-controller="CurrentUserCtrl as currentUserCtrl" class="b-personal-space">
	<div class="b-header__userbar b-header__userbar_right">
		<span id="js-plugin-version" class="b-plugin-version"></span>
		<script>
			$(document).ready(function(){

				function addPluginVersion(pluginVersion) {
					$('#js-plugin-version').text('plugin version: ' + pluginVersion + ' / ');
				}

				setTimeout(function(){
					if($('#bp-plugin-version').val().length > 0) {
						addPluginVersion($('#bp-plugin-version').val());
					}
				}, 2000);

				$('body').on('change', '#bp-plugin-version', function(){
					if($(this).val().length > 0) {
						addPluginVersion($(this).val());
					}
				});

			});
		</script>
		<!--<i class="fa fa-sign-in b-plugin-version"></i>-->
		<span ng-if="currentUserCtrl.currentUser" class="b-header-userbar-name">
			<a href ng-click="currentUserCtrl.logout()" class="b-header-userbar-name">
				{{ currentUserCtrl.currentUser }} <i class="fa fa-sign-out b-header-userbar__icon"></i>
			</a>
		</span>
		<a href ui-sref="login"
			class="b-header-userbar-name"
			ng-if="!currentUserCtrl.currentUser">
			Login
		</a>
	</div>
	<div class="b-hub-status js-header-dropdown g-right">
		<a href="#" ng-class="{'b-hub-status__btn_active' : currentUserCtrl.hubStatus }" class="b-hub-status__btn g-margin-right-half js-notification">hub <i class="fa fa-angle-down"></i></a>
		<div class="b-hub-status__dropdown">
			<div ng-if="!currentUserCtrl.hubStatus">
				<div class="header">
					Register to Hub
				</div>
				<div class="body">
					<div class="b-form-group g-margin-bottom">
						<div class="g-text g-margin-bottom-half">Login</div>
						<input type="text" class="b-form-input b-form-input_full" ng-model="currentUserCtrl.login">
					</div>
					<div class="b-form-group">
						<div class="g-text g-margin-bottom-half">Password</div>
						<input type="password" class="b-form-input b-form-input_full" value="******" ng-model="currentUserCtrl.pass">
					</div>
				</div>
				<div class="footer">
					<a href="https://hub.subut.ai" target="_blank" class="b-form-label">Sign Up</a>
					<button class="b-btn b-btn_green g-right" ng-click="currentUserCtrl.hubRegister()">Register</button>
				</div>
			</div>
			<div ng-if="currentUserCtrl.hubStatus">
				<ul class="list">
					<li style="text-align: center;">
						<a href>Already registered</a>
						<div class="date"></div>
					</li>
					<li>
						<div style = "width: 100%; text-align: center">
						<button class = "b-btn b-btn_green" ng-click = "currentUserCtrl.hubHeartbeat()">Send Heartbeat</button>
						</div>
					</li>
				</ul>
				<a href ng-click="currentUserCtrl.hubUnregister()" class="show-more">Unregister</a>
			</div>
		</div>
	</div>

	<div class="b-hub-status js-header-dropdown g-right">
		<a href="#" 
		ng-class="{'b-hub-status__btn_active' : currentUserCtrl.notificationNew }" 
		class="b-hub-status__btn g-margin-right-half js-notification" 
		ng-click="currentUserCtrl.notificationNew = false">
			Notifications 
			<i class="fa fa-angle-down"></i>
		</a>
		<div class="b-hub-status__dropdown">
			<ul class="list">
				<li ng-repeat="notification in currentUserCtrl.notifications">
					<a href="#">
						{{ notification.message }}
					</a>
					<div class="date">
						{{ notification.date }}
					</div>
					<div class="b-dropdown-buttons" ng-if="notification.links">
						<a ng-repeat="link in notification.links" href="{{ link.href }}" class="b-btn b-btn_green">{{ link.text }}</a>
					</div>
				</li>
				<li ng-if="currentUserCtrl.notifications.length <= 0" style="text-align: center;">
					<a href>No logs</a>
				</li>
				<!--<li><a href="#">Your SS version is obsolete, please update
					it to 4.0.0-RC7</a>
					<div class="date">8 February at 22:25</div>
					<div class="buttons">
						<a href="#" class="b-btn b-btn_green">Register</a>
						<a href="#" class="b-btn b-btn_white">Ignore</a>
					</div>
				</li>-->
			</ul>
			<a href ng-click="currentUserCtrl.clearLogs()" class="show-more">Clear</a>
		</div>
	</div>
</div>
